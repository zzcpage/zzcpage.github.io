---
title: 4. Java对象与类

categories: 
    - JavaSE
tags:
    - JAVA
    - JAVASE
---

面向对象程序设计OOP(Object Oriented Programming)。

类用于描述对象所具有的属性和方法，具体的对象称为类的一个实例。

封装也就是将数据和行为组合在一个包中，并对对象的使用者隐藏了数据的实现方式。

对象的三个特性，行为，状态，标识。

对象的行为描述了对象具有哪些操作，对象的状态（状态也就是对象当前的特征信息）决定了在不同情况下相应的操作的响应，对象的标识描述了不同的实例对象。

>类之间的关系

1. 依赖关系(uses-a)

    如果一个类A的方法使用了另一个类B，那么就形成了依赖关系。
    A依赖于B。（过多的依赖会使得类之间的耦合度高）

2. 聚合关系(has-a)

    如果类A包含一些类B，那么A和B是聚合关系。

3. 继承关系(is-a)

    父类和子类的关系，也就是继承关系。

UML（Unified Modeling Language,统一建模语言）中类关系的表示：
![a1](/images/UML.PNG)

Java中的对象通过new进行创建，通过new创建一个新的对象变量。一个对象变量并没有实际包含一个对象，而仅仅引用一个对象。通过new 操作符的返回值也是一个引用。这可以理解为Java中所有的对象变量实际上就是一个指针，指向实际对象所在的地址。

>1. 更改器方法(get),访问器方法(set)

注意不要编写返回引用可变对象的访问器方法。如果返回了可变对象，那么在类外部对返回对象的改变，同时也会影响到类内部的变量。
如果需要返回一个可变对象的引用，首先因该对它进行克隆(clone)。对象的clone是指存放在另一个位置上的对象副本。
如果需要返回一个可变数据域的拷贝，就应该使用 clone。

```java
class Employee
{
    public boolean equals(Employee other)
    {
        return name.equals(other.name);
    }
}
```
对于上段代码，我们可以看出，在equals方法中，调用了other的私有变量。对于Javaa来说，类的方法可以访问该类的任何对象的遍私有变量。
类方法可以访问所属类的私有特性。

>2. 构造器

    •构造器与类同名
    •每个类可以有一个以上的构造器
    •构造器可以有 0 个、1 个或多个参数
    •构造器没有返回值
    •构造器总是伴随着 new 操作一起调用

>3. 隐式参数与显示参数

以下列代码为例：

```java
class B {
        private int a ;
        public B(int a){
            this.a = a ;
        }

        public int getA(){return this.a;}

        public void setA(int a){
            this.a = a ;
        }
    }
```

我们对于方法setA,可以看出对于参数a是显示的参数。而隐式参数是谁呢？隐式参数是调用该方法调用的类对象，通过关键字this表示隐式参数。

第一个参数称为隐式 （ implicit ) 参数， 是出现在方法名前的Employee 类对象。第二个参数位于方法名后面括号中的数值，这是一个显式 （ explicit)参数（ 有些人把隐式参数称为方法调用的目标或接收者。

也就是说，this表明该方法的调用者。

>4. 访问修饰符

修饰符| 作用 | 作用域
---- | ---- | ----
public | 公开的 | 任意类都能访问
private | 私有的 | 只能被定义它们的类使用
final | final 修饰符大都应用于基本 （primitive ) 类型域，或不可变（immutable)类的域（如果类中的每个方法都不会改变其对象， 这种类就是不可变的类)。
static | 静态域（类域）和静态方法。对于静态域变量，该变量属于类，而不属于任何独立的对象，通过类就能够直接访问到静态域变量(公开的)，实例对象，也能够访问到该变量，但是该变量属于类，所有对象访问到的静态域对象都是一样的。对于静态域一般可以用于设置静态常量，通过类名就能引用，但是不会被修改。对于静态方法，加在方法名之前，静态方法可以通过类名直接调用，静态方法不属于单独的对象。静态方法不具有this参数，所以静态方法不能访问非静态域的实例域。

在下面两种情下使用静态方法：

1. 一 方法不需要访问对象状态，其所需参数都是通过显式参数提供（例如：Math.pow) 
2. 一个方法只需要访问类的静态域（例如：Employee.getNextld）。

#### 初始化数据域

>默认域初始化

如果在构造器中没有显式地给域赋予初值，那么就会被自动地赋为默认值： 数值为 0、布尔值为 false、 对象引用为 null。
尽量对对象进行赋初始值，而不是采用默认初始值

>构造器初始化
通过this可以调用同一个类的另一个构造器。如下所示：
```java
    public Employee(String double){
        // calls Employee(String, double)
        this("Employee #" + nextld, s);
        nextld++;
    }
```
通过this，引用到了同一个Employee的另一个的构造函数，对类对象进行初始化。

> 在声明中赋值

> 在初始化块赋值

初始块也就是通过{}包含的一段代码块。只要构造类的对象，这些块就会被执行。初始化块的执行顺序，首先运行初始化块，然后才运行构造器的主体部分。

对于静态域的初始化，需要加上关键字static
static{
    //进行初始化
}

> Java调用构造器的步骤

1. 所有数据域被初始化默认值(0,false,null)
2. 按照类声明中出现的次序，依次执行所有域初始化语句或初始化块。
3. 如果构造器第一行调用了其它构造器，则调用其它构造器
4. 执行这个构造器主体。

构造器是最后执行的，先执行声明和代码块语句。

#### Java参数调用

方法参数共有两种类型：

1. 基本数据类型（数字、布尔值K
2. 对象引用。

Java 程序设计语言总是采用按值调用。也就是说， 方法得到的是所有参数值的一个拷贝，特别是，方法不能修改传递给它的任何参数变量的内容。一个方法，无法改变基本数据类型的参数，但是对象引用作为参数就不同了。对于引用参数就不一样了，方法得到的是对象引用的拷贝，对象引用及其他的拷贝同时引用同一个对象。

>总结

1. 一个方法不能修改一个基本数据类型的参数（即数值型或布尔型）。
2. 一个方法可以改变一个对象参数的状态。
3. 一个方法不能让对象参数引用一个新的对象。（因为Java的引用对象，并不是真正的引用(只是值的传递),可以通过反证进行证明）

#### 重载(overloading)和重写(overwrite)

>重载

如果多个方法（比如， StringBuilder 构造器方法）有相同的名字、 不同的参数，便产生了重载。对于不同的重载方法， 通过方法给出的参数类型和特定的方法调用所使用的值类型进行匹配来挑选相应的方法（返回值不作为特征）。。如果编译器找不到匹配的参数， 就会产生编译时错误，因为根本不存在匹配， 或者没有一个比其他的更好。（这个过程被称为重载解析（overloading resolution)。）

对于一个方法的签名(signature)，包含方法名，方法参数类型构成。方法签名=方法名(参数类型)。


>重写

#### Java的包

Java允许使用包(package)将类组织起来，借助于包可以方便地组织自己的代码，并将自己的代码与别人提供的代码库分开管理。使用包的主要原因是确保类名的唯一性(全限定类名)，一般我们对包名的命名规则是以因特网域名的逆序形式作为包名，并且对于不同的项目使用不同的子包。

一个类可以使用所属包中的所有类，以及其他包中的公有类(public class)。

import语句不仅可以导入类，还增加了导入静态方法和静态域的功能。
>import static java.lang.System.* 
通过上述语句就可以直接使用System类的静态方法和静态域，而不必加类名前缀。
这样就可以直接在程序中使用out.println("hello world");而不用加前缀。

把一个类放到一个包中， 需要通过package 指定所属的包。如果没有设置，则类被放在默认的包(default package)。


> 对于包的作用域

对于标记public部分，可以被任意的类使用。标记为private部分，只能被定义它们的类使用。如果没有指定public或private，这个部分(类，方法或变量)可以被同一个包中的所有方法访问。

> 类路径

为了使类能够被多个程序共享，需要做到下面几点：

1 ) 把类放到一个目录中， 例如 /home/user/classdir。需要注意， 这个目录是包树状结构的基目录。如果希望将 com.horstmann.corejava.Employee 类添加到其中，这个Employee.class类文件就必须位于子目录 /home/user/classdir/com/horstmann/corejava 中。

2 ) 将 JAR 文件放在一个目录中，例如：/home/user/archives。

3 ) 设置类路径（classpath)。类路径是所有包含类文件的路径的集合。

#### 类路径包括：

•基目录 /home/user/classdir或 c:\classes；

•当前目录 (.);

•JAR 文件 /home/user/archives/archive.jar或c:\archives\archive.jar 

从 Java SE 6 开始，可以在 JAR 文件目录中指定通配符，如下：/home/user/dassdir:.:/home/aser/archives/*
或者c:\classdir;.;c:\archives\*

>假定虚拟机要搜寻 com.horstmann.corejava.Employee 类文件。它首先要查看存储在 jre/
lib 和jre/lib/ext 目录下的归档文件中所存放的系统类文件。显然，在那里找不到相应的类文件，然后再查看类路径。然后查找以下文件：
>>•/home/user/classdir/com/horstmann/corejava/Employee.class
•com/horstmann/corejava/Employee.class 从当前目录开始
•com/horstmann/corejava/Employee.class inside /home/user/archives/archive.jar

> 设置类路径

如果需要指定类的路径，可以借助-classpath来指定类路径。


#### 文档注释

>通过/** */开始注释。

对于代码的描述性句子，一般在/** */第一行进行编写，对于概要性的句子，可以使用HTML修饰符进行修饰(但是不要使用h1标签),如果需要键入等宽代码，使用{@code}。

>方法主要使用的注释

@param 变量描述

@return 返回值描述

@throws 抛出异常描述

>通用注释

@author 姓名
@version 版本信息
@since 从哪个版本开始加入的
@deprecated 描述该类或方法或变量不再使用
@see 增加一个超级链接 , 可以通过全限定类名作为超链接
eg: @see com.itheima.Employee#raiseSalary(double ),链接指向Employee下的raiseSalary(double)方法



> 总结

所有Java对象都是在堆中构造的，构造器总是伴随着new操作符一起使用。

#### 类设计技巧

1. 数据私有
2. 对数据初始化
3. 不要再类中使用过多的基本类型
4. 不是所有的域都需要独立的get/set方法
5. 将职责过多的类进行分解
6. 类名和方法名要能够体现它们的职责，也就是见名知义
7. 优先使用不可变的类


